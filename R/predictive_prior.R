#' @name Prior_y 
#' @rdname Prior_y
#' @title Prior predictive distribution of the count in the control group
#' @description Density, distribution function, quantile function and random 
#' generation for the prior predictive distribution of the count in the control group.
#' @details The prior predictive distribution of the count \eqn{y} is the Poisson-Gamma 
#'  distribution 
#' with shape parameter \eqn{a} and hyperrate parameter \eqn{b/T}, which is also 
#' the negative binomial distribution with shape \eqn{a} and probability of success 
#' \eqn{b/(b+T)}.
#' 
#' @param y,q vector of non-negative \strong{integer} quantiles 
#' @param p vector of probabilities
#' @param a,b non-negative shape parameter and rate parameter of the Gamma prior distribution on the rate \eqn{\mu}
#' @param T sample size of the control group
#' @param n number of observations to be simulated
#' @param ... other arguments passed to \code{\link[stats]{NegBinomial}}
#' 
#' @return \code{dprior_y} gives the density, \code{pprior_y} the distribution function, \code{qprior_y} the quantile function, and \code{rprior_y} samples from the distribution.
#' 
#' @note \code{Prior_y} is a generic name for the functions documented. 
#' 
#' @examples 
#' barplot(dprior_y(0:10, 2, 2, 1))
#' 
NULL
#'
#' @rdname Prior_y
#' @export 
dprior_y<-function(y, a, b, T, ...){
  return( setNames(dnbinom(y, a, b/(b+T), ...), paste("y=",y,sep="")) )
}
#'
#' @rdname Prior_y
#' @export 
pprior_y<-function(q, a, b, T, ...){
  return( setNames(pnbinom(q, a, b/(b+T), ...), paste("y\u2264",q,sep="")) )
}
#'
#' @rdname Prior_y
#' @export 
qprior_y<-function(p, a, b, T, ...){
  return( qnbinom(p, a, b/(b+T), ...) )
}
#'
#' @rdname Prior_y
#' @export 
rprior_y <- function(n, a, b, T){
  return( rnbinom(n, a, b/(b+T)) )
}


#' @name Prior_x 
#' @rdname Prior_x
#' @title Prior predictive distribution of the count in the treated group
#' @description Density, distribution function, quantile function and random 
#' generation for the prior predictive distribution of the count in the treated group.
#' @details The prior predictive distribution of the count \eqn{x} is the 
#' \code{\link[=PGB2Dist]{Poisson-Gamma-Beta2 distribution}} 
#' with shape parameters \eqn{a}, \eqn{d}, \eqn{c},  
#' and hyperrate parameter \eqn{b/(b+T)}. 
#' 
#' @param x,q vector of non-negative \strong{integer} quantiles 
#' @param p vector of probabilities
#' @param a,b non-negative shape parameter and rate parameter of the Gamma prior distribution on the rate \eqn{\mu}
#' @param c,d non-negative shape parameters of the prior distribution on \eqn{\phi} 
#' @param T sample size of the control group
#' @param n number of observations to be simulated
#' 
#' @return \code{dprior_x} gives the density, \code{pprior_x} the distribution function, \code{qprior_x} the quantile function, and \code{rprior_x} samples from the distribution.
#' 
#' @note \code{Prior_x} is a generic name for the functions documented. 
#' 
#' @examples 
#' barplot(dprior_x(0:10, 2, 3, 4, 5, 10))
#' qprior_x(0.5, 2, 3, 4, 5, 10)
#' pprior_x(5, 2, 3, 4, 5, 10)
#' 
NULL
#'
#' @rdname Prior_x
#' @export 
dprior_x <- function(x, a, b, c, d, T){
    return( setNames(dPGB2(x,a,d,c,b/(b+T)), paste("x=",x,sep="")) )
}
#'
#' @rdname Prior_x
#' @export 
pprior_x <- function(q, a, b, c, d, T){
  return( setNames(pPGB2(q,a,d,c,b/(b+T)), paste("x\u2264",q,sep="")) )
}
#'
#' @rdname Prior_x
#' @export 
qprior_x <- function(p, a, b, c, d, T){
  return( qPGB2(p,a,d,c,b/(b+T)) ) 
}
#'
#' @rdname Prior_x
#' @export 
rprior_x <- function(n, a, b, c, d, T){
  return( rPGB2(n,a,d,c,b/(b+T)) )
}


#' @name Prior_x_given_y 
#' @rdname Prior_x_given_y
#' @title Prior predictive distribution of the count \eqn{x} in the treated group 
#' conditionally to the count \eqn{y} in the treated group
#' @description Density, distribution function, quantile function and random 
#' generation for the conditional prior predictive distribution of \eqn{x} 
#' given \eqn{y}. 
#' @details The prior predictive distribution of the count \eqn{x} is the 
#' \code{\link[=BetaNegativeBinomialDist]{Beta-negative binomial distribution}} 
#' with shape parameters \eqn{a+y}, \eqn{d}, \eqn{c}.
#' 
#' @param x,q vector of non-negative \strong{integer} quantiles 
#' @param y count (integer) in the control group
#' @param p vector of probabilities
#' @param a non-negative shape parameter of the Gamma prior distribution on the rate \eqn{\mu}
#' @param c,d non-negative shape parameters of the prior distribution on \eqn{\phi} 
#' @param n number of observations to be simulated
#' 
#' @return \code{dprior_x_given_y} gives the density, \code{pprior_x_given_y} the distribution function, \code{qprior_x_given_y} the quantile function, and \code{rprior_x_given_y} samples from the distribution.
#' 
#' @note \code{Prior_x_given_y} is a generic name for the functions documented. 
#' 
#' @examples 
#' barplot(dprior_x_given_y(0:10, 5, 3, 10, 20))
#' dprior_x_given_y(5, 0:5, 3, 10, 20) # pb names
#' a <- 3; b <- 1; c <- 10; d <- 20
#' T <- 2
#' dprior_x(x=5, a=a, b=b, c=c, d=d, T=T)
#' sum(dprior_x_given_y(x=5, y=0:100, a, c, d)*dprior_y(0:100, a, b, T))
NULL
#'
#' @rdname Prior_x_given_y
#' @export 
dprior_x_given_y <- function(x, y, a, c, d){
  return( setNames(dbeta_nbinom(x,a+y,d,c), paste("x=",x,sep="")) ) 
}
#'
#' @rdname Prior_x_given_y
#' @export 
pprior_x_given_y <- function(q, y, a, c, d){
  return( setNames(pbeta_nbinom(q,a+y,d,c),  paste("x\u2264",q,sep="")) ) 
}
#'
#' @rdname Prior_x_given_y
#' @export 
qprior_x_given_y <- function(p, y, a, c, d){
  return( qbeta_nbinom(p,a+y,d,c) )  
}
#'
#' @rdname Prior_x_given_y
#' @export 
rprior_x_given_y <- function(n, a, c, d){
  return( rbeta_nbinom(n,a+y,d,c) )
}
